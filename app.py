# ==========================================
# Project: מתווך בקליק | Version: 1161
# Last Updated: 2026-02-17 | 01:50
# ==========================================

import streamlit as st
import google.generativeai as genai
import json, re

st.set_page_config(page_title="מתווך בקליק", layout="wide")
st.markdown('<div id="top"></div>', unsafe_allow_html=True)

SYLLABUS = {
    "חוק המתווכים במקרקעין": ["רישוי והגבלות עיסוק", "חובת הגינות וזהירות", "הזמנת תיווך ובלעדיות"],
    "תקנות המתווכים (פרטי הזמנה)": ["דרישות חובה בטופס", "זיהוי נכס וצדדים", "פירוט דמי התיווך"],
    "תקנות המתווכים (פעולות שיווק)": ["פעולות שיווק", "הרחבות לבלעדיות", "חובת הוכחת פעילות"],
    "חוק המקרקעין": ["בעלות וזכויות", "בתים משותפים", "עסקאות נוגדות והערות אזהרה"],
    "חוק הגנת הדייר": ["דיירות מוגנת", "עילות פינוי", "זכויות וחובות דייר"],
    "חוק המכר (דירות)": ["מפרט וחובת גילוי", "בדק ואחריות", "איחור במסירה"],
    "חוק החוזים": ["כריתת חוזה", "פגמים בחוזה", "תרופות בשל הפרה"],
    "חוק הגנת הצרכן": ["הטעיה בפרסום", "ביטול עסקה", "חובות גילוי"],
    "חוק עבירות עונשין": ["מרמה והונאה", "זיוף מסמכים", "אחריות פלילית"],
    "חוק שמאי מקרקעין": ["תפקיד השמאי", "סמכויות והגדרות", "בסיס השומה"],
    "חוק התכנון והבנייה": ["היתרי בנייה", "היטל השבחה", "תוכניות מתאר"],
    "חוק מיסוי מקרקעין": ["מס שבח", "מס רכישה", "פטורים והקלות"],
    "חוק הירושה": ["ירושה וצוואה", "ניהול עיזבון", "העברת מקרקעין"],
    "חוק הוצאה לפועל": ["עיקול מקרקעין", "מימוש משכנתאות", "פינוי נכסים"],
    "פקודת הנזיקין": ["רשלנות מקצועית", "מצג שווא", "חובת זהירות"]
}

def ask_ai(prompt):
    try:
        genai.configure(api_key=st.secrets["GEMINI_API_KEY"])
        model = genai.GenerativeModel('gemini-2.0-flash')
        res = model.generate_content(prompt)
        return res.text if (res and res.text) else None
    except: return None

def fetch_content(topic, sub):
